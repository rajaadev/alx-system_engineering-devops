#!/bin/bash

# Display active internet connections (only servers)
echo "Active Internet connections (only servers)"
echo "Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name"

# Display listening TCP ports
netstat -tuln | awk '$NF ~ /^[0-9\/]+$/ {print "tcp",$6,$7}' | while read proto recvq sendq local pid_program; do
    # Extract PID and program name
    pid=$(echo "$pid_program" | awk -F'/' '{print $1}')
    program=$(echo "$pid_program" | awk -F'/' '{print $NF}')
    echo "$proto $recvq $sendq $local *:* $pid/$program"
done

# Display listening UDP ports
netstat -uln | awk '$NF ~ /^[0-9\/]+$/ {print "udp",$6,$7}' | while read proto recvq sendq local pid_program; do
    # Extract PID and program name
    pid=$(echo "$pid_program" | awk -F'/' '{print $1}')
    program=$(echo "$pid_program" | awk -F'/' '{print $NF}')
    echo "$proto $recvq $sendq $local *:* $pid/$program"
done
